export { future as theme } from 'mdx-deck/themes';
import { Appear } from 'mdx-deck';
import { CodeSurfer } from 'mdx-deck-code-surfer';
import nightOwl from 'prism-react-renderer/themes/nightOwl';

## Better Context with React Hooks

<br />
<br />
<br />
<br />

#### Gareth Kloeden

##### March 13, 2019

---

## What is Context?

<ul style={{ textAlign: 'left' }}>
  <Appear>
    <li style={{ margin: '25px 0' }}>Pass data through the component tree without prop drilling</li>
    <li style={{ margin: '25px 0' }}>Share values between components without a direct parent - child relationship</li>
    <li style={{ margin: '25px 0' }}>
      API: <strong>Provider</strong> and <strong>Consumer</strong> components
    </li>
    <li style={{ margin: '25px 0' }}>Officially released in February 2018 with React 16.3</li>
  </Appear>
</ul>

---

<img src="./assets/prop-drilling-diagram.svg" />

---

<img src="./assets/context-diagram.svg" />

---

## Context API - Creation & Provider

---

<CodeSurfer
  code={require('!raw-loader!./components/Parent.js')}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  steps={[
    { range: [1, 37] },
    { range: [1, 4] },
    { lines: [6] },
    { range: [8, 22] },
    { range: [24, 34] },
    { lines: [25] },
    { range: [28, 31] },
  ]}
/>

---

## ChildOne Component

---

<CodeSurfer
  code={require('!raw-loader!./components/ChildOne.js')}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  steps={[{ range: [1, 12] }, { lines: [7], notes: 'No props passed to ChildTwo' }]}
/>

---

## ChildTwo Component

---

<CodeSurfer
  code={require('!raw-loader!./components/ChildTwo.js')}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  steps={[
    { range: [1, 23] },
    { lines: [3] },
    { range: [7, 18] },
    { range: [8, 17], notes: 'Render prop to pass context Provider value prop' },
  ]}
/>

---

import Parent from './components/Parent';

<Parent />

---

## Sidenote: Context vs Redux

<Appear>
  <h3>Does context replace the need for Redux?</h3>
  <h1>
    <em>MAYBE</em>
  </h1>
  <p>Redux changes the structure of your app, context doesn't really, both increase complexity</p>
  <p>Redux is more than just global store - Flux architecture, immutability, pure functions, etc</p>
  <p>Redux dev tools are really really good; debugging context with React dev tools is a pain</p>
  <p>
    <strong>If you just need to make state easily available, context is a good solution</strong>
  </p>
  <p>Same for MobX, Cerebral, Apollo Link State, etc...</p>
</Appear>

```notes
Nested context gets reeeallly gnarly really quickly
Even worse with hooks right now as the dev tools don't support complex state inspection in hooks
```

---

## Render Props are Awesome

<Appear>
  <h2 className="iWJQFI">And Also Annoying</h2>
</Appear>

```notes
Render props allow reusable component logic and good design patterns
They just get really complex really quickly
```

---

<CodeSurfer
  code={require('!raw-loader!./components/NestedContext.js')}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  steps={[
    { range: [1, 85] },
    { range: [1, 5] },
    { range: [7, 21] },
    { range: [23, 37] },
    { range: [39, 53] },
    { range: [55, 81] },
    { lines: [58, 59, 60, 61, 76, 77, 78] },
    { lines: [62, 63, 64, 65, 73, 74, 75] },
    { range: [66, 72] },
  ]}
/>

---

import NestedContext from './components/NestedContext';

<NestedContext />

---

<img src="./assets/context-lol.png" />

<Appear>
  <h2 className="iWJQFI">This is insane</h2>
</Appear>

---

## Hello Hooks

<Appear>
  <p>Hooks "let you use state and other React features without writing a class" (React Docs)</p>
  <p>A way to re-use/share stateful logic between components</p>
  <p>Functional components have access to everything class components do (state, lifecycle)</p>
  <p>Released in February 2019 with React 16.7</p>
</Appear>

---

## useContext

<Appear>
  <p>
    A hook that accepts one argument - a value returned from <code>React.createContext()</code>
  </p>
  <p>Immediate access to the context object passed in (no consumer component needed)</p>
  <p>Unlike other hooks, doesn't really add new features, just makes context a lot nicer</p>
</Appear>

---

<CodeSurfer
  code={require('!raw-loader!./components/usecontext/HookProvider.js')}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  steps={[
    { range: [1, 35] },
    { range: [1, 3] },
    { range: [5, 7] },
    { range: [9, 13] },
    { range: [15, 24] },
    { range: [26, 32] },
    { lines: [29] },
  ]}
/>

---

<CodeSurfer
  code={require('!raw-loader!./components/usecontext/HookContainer.js')}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  steps={[{ range: [1, 14] }, { range: [1, 4] }, { range: [6, 12] }]}
/>

---

<CodeSurfer
  code={require('!raw-loader!./components/usecontext/HookFirstChild.js')}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
/>

---

<CodeSurfer
  code={require('!raw-loader!./components/usecontext/HookSecondChild.js')}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  steps={[
    { range: [1, 27] },
    { range: [1, 3] },
    { range: [5, 6] },
    { lines: [6] },
    { range: [8, 24] },
    { lines: [11] },
    { range: [13, 22] },
    { lines: [16, 21] },
  ]}
/>

---

import HookContainer from './components/usecontext/HookContainer';

<HookContainer />

---

<CodeSurfer
  code={require('!raw-loader!./components/NestedContext.js')}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  steps={[{ range: [1, 84] }, { range: [55, 81] }]}
/>

---

<CodeSurfer
  code={require('!raw-loader!./components/usecontext/NestedHookContext.js')}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  steps={[
    { range: [1, 61] },
    { range: [1, 5] },
    { range: [7, 17] },
    { range: [19, 33] },
    { range: [35, 45] },
    { range: [47, 59] },
  ]}
/>

---

import NestedHookContext from './components/usecontext/NestedHookContext';

<NestedHookContext />

---

<img src="./assets/render-props-vs-hooks.png" />

```notes
almost 30 lines of code vs 12, if you care about that sort of thing
```

---

## Destructuring Context

<Appear>
  <p>
    Value from <code>createContext()</code> can be destructured with render props, but <strong>not with hooks</strong>.
  </p>
  <p>
    <code>const {`{ Consumer, Provider }`} = createContext()</code>
  </p>
  <h1>:(</h1>
  <p>
    <code>const MyCoolContext = createContext()</code>
  </p>
  <h1>:)</h1>
</Appear>

---

## Conclusions

<Appear>
  <p>Hooks are awesome</p>
  <p>
    (write whole apps with no <em>this</em>!)
  </p>
  <p>
    <code>useContext()</code> makes code more readable
  </p>
  <p>Try context if you haven't</p>
  <p>(especially if you reach for Redux, MobX, whatever a lot)</p>
</Appear>

---

## Thank you

<p>https://better-context-with-hooks.netlify.com</p>

<p>https://github.com/garethpbk/better-context-with-hooks</p>

<p>@garethpbk on github, @garethbk everywhere else</p>
